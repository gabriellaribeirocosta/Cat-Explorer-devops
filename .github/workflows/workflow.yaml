name: Continuous Integration

on: 
  push:
    branches: [main]
  pull_request:

jobs: 
    ci-cd:
        name: Build and Deploy to Vercel 
        runs-on: ubuntu-latest

        steps:
            - uses: actions/checkout@v3

            - name: using Node.js
              uses: actions/setup-node@v2
              with:
                node-version: 22

            - name: Install dependencies
              run: npm install

            - name: Run Build
              run: npm run build
            
            - name: Run Tests
              run: npm run test

            - name: Deploy to Vercel
              if: github.event_name == 'push'
              run: npx vercel --prod --yes --token ${{ secrets.VERCEL_TOKEN }}